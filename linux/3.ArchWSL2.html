<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Arch-WSL2 | 唤雨考拉的笔记本</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.png">
    <meta name="description" content="对于唤雨考拉来说，这是一个百宝箱，但对于其他人来说，可能是一本用处不大的笔记本。">
    <meta name="keywords" content="notebook,Therainisme,Algorithm,题解,算法,编程,学习笔记">
    <meta name="google-site-verification" content="lIhR5J6yRQNU2obnE35OxMfrUxOj7VjwjNbVE0gh7sk">
    
    <link rel="preload" href="/assets/css/0.styles.d44d29f7.css" as="style"><link rel="preload" href="/assets/js/app.cfcb1174.js" as="script"><link rel="preload" href="/assets/js/2.309a0ee7.js" as="script"><link rel="preload" href="/assets/js/14.ace9b7b0.js" as="script"><link rel="prefetch" href="/assets/js/10.9c02f1d7.js"><link rel="prefetch" href="/assets/js/11.f4e146af.js"><link rel="prefetch" href="/assets/js/12.0523a642.js"><link rel="prefetch" href="/assets/js/13.82a1bdd3.js"><link rel="prefetch" href="/assets/js/15.7d884bb4.js"><link rel="prefetch" href="/assets/js/16.1d58a736.js"><link rel="prefetch" href="/assets/js/17.a824fe12.js"><link rel="prefetch" href="/assets/js/18.9b4ea3f3.js"><link rel="prefetch" href="/assets/js/19.d01c8d9f.js"><link rel="prefetch" href="/assets/js/20.beeaadf8.js"><link rel="prefetch" href="/assets/js/21.4a851997.js"><link rel="prefetch" href="/assets/js/22.ca58cb08.js"><link rel="prefetch" href="/assets/js/23.eb80cd3a.js"><link rel="prefetch" href="/assets/js/24.78f8d71c.js"><link rel="prefetch" href="/assets/js/25.20a2eda8.js"><link rel="prefetch" href="/assets/js/26.9df63857.js"><link rel="prefetch" href="/assets/js/27.2f12aa3b.js"><link rel="prefetch" href="/assets/js/28.3f46ab6c.js"><link rel="prefetch" href="/assets/js/29.ca5f5b23.js"><link rel="prefetch" href="/assets/js/3.de1f54d1.js"><link rel="prefetch" href="/assets/js/30.9ae29b3a.js"><link rel="prefetch" href="/assets/js/31.e9d3f255.js"><link rel="prefetch" href="/assets/js/32.2e3c72fc.js"><link rel="prefetch" href="/assets/js/33.3055d9d3.js"><link rel="prefetch" href="/assets/js/34.53115bb2.js"><link rel="prefetch" href="/assets/js/35.5f9ed2e6.js"><link rel="prefetch" href="/assets/js/36.84d0c012.js"><link rel="prefetch" href="/assets/js/37.d667092d.js"><link rel="prefetch" href="/assets/js/38.60387a47.js"><link rel="prefetch" href="/assets/js/39.0e036946.js"><link rel="prefetch" href="/assets/js/4.11d079a9.js"><link rel="prefetch" href="/assets/js/40.153afd81.js"><link rel="prefetch" href="/assets/js/41.bc54e8c3.js"><link rel="prefetch" href="/assets/js/42.ca058785.js"><link rel="prefetch" href="/assets/js/43.08f5caf4.js"><link rel="prefetch" href="/assets/js/44.f8b87993.js"><link rel="prefetch" href="/assets/js/45.0fa15cdb.js"><link rel="prefetch" href="/assets/js/46.6a8c7df6.js"><link rel="prefetch" href="/assets/js/47.663ab6cb.js"><link rel="prefetch" href="/assets/js/48.4568c8f5.js"><link rel="prefetch" href="/assets/js/49.82c864dd.js"><link rel="prefetch" href="/assets/js/5.2037231f.js"><link rel="prefetch" href="/assets/js/50.9aec1096.js"><link rel="prefetch" href="/assets/js/51.b6a70f7a.js"><link rel="prefetch" href="/assets/js/52.fd19c0f4.js"><link rel="prefetch" href="/assets/js/53.9b0b5c8b.js"><link rel="prefetch" href="/assets/js/54.0930df4a.js"><link rel="prefetch" href="/assets/js/55.7e8f404b.js"><link rel="prefetch" href="/assets/js/56.3e3468c5.js"><link rel="prefetch" href="/assets/js/6.fb06fb3b.js"><link rel="prefetch" href="/assets/js/7.f6d5a488.js"><link rel="prefetch" href="/assets/js/8.e3245d57.js"><link rel="prefetch" href="/assets/js/9.b80b43ca.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d44d29f7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">唤雨考拉的笔记本</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="天书" class="dropdown-title"><span class="title">天书</span> <span class="arrow down"></span></button> <button type="button" aria-label="天书" class="mobile-dropdown-title"><span class="title">天书</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/-1.hooks.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/code-snippets/index.html" class="nav-link">
  代码片段
</a></li><li class="dropdown-item"><!----> <a href="/algorithm/1.每日一题.html" class="nav-link">
  算法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="戏水" class="dropdown-title"><span class="title">戏水</span> <span class="arrow down"></span></button> <button type="button" aria-label="戏水" class="mobile-dropdown-title"><span class="title">戏水</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/question/1.先导.html" class="nav-link">
  杂题记录
</a></li><li class="dropdown-item"><!----> <a href="/linux/1.ubuntu.html" class="nav-link">
  环境保护大使
</a></li><li class="dropdown-item"><!----> <a href="/interview/2.css.html" class="nav-link">
  Interview
</a></li><li class="dropdown-item"><!----> <a href="/utils/1.pandoc.html" class="nav-link">
  偷懒技术
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="废纸篓" class="dropdown-title"><span class="title">废纸篓</span> <span class="arrow down"></span></button> <button type="button" aria-label="废纸篓" class="mobile-dropdown-title"><span class="title">废纸篓</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/waste-paper/1.java.html" class="nav-link">
  Java
</a></li></ul></div></div> <a href="https://github.com/Therainisme/Notebook" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="天书" class="dropdown-title"><span class="title">天书</span> <span class="arrow down"></span></button> <button type="button" aria-label="天书" class="mobile-dropdown-title"><span class="title">天书</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/-1.hooks.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/code-snippets/index.html" class="nav-link">
  代码片段
</a></li><li class="dropdown-item"><!----> <a href="/algorithm/1.每日一题.html" class="nav-link">
  算法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="戏水" class="dropdown-title"><span class="title">戏水</span> <span class="arrow down"></span></button> <button type="button" aria-label="戏水" class="mobile-dropdown-title"><span class="title">戏水</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/question/1.先导.html" class="nav-link">
  杂题记录
</a></li><li class="dropdown-item"><!----> <a href="/linux/1.ubuntu.html" class="nav-link">
  环境保护大使
</a></li><li class="dropdown-item"><!----> <a href="/interview/2.css.html" class="nav-link">
  Interview
</a></li><li class="dropdown-item"><!----> <a href="/utils/1.pandoc.html" class="nav-link">
  偷懒技术
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="废纸篓" class="dropdown-title"><span class="title">废纸篓</span> <span class="arrow down"></span></button> <button type="button" aria-label="废纸篓" class="mobile-dropdown-title"><span class="title">废纸篓</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/waste-paper/1.java.html" class="nav-link">
  Java
</a></li></ul></div></div> <a href="https://github.com/Therainisme/Notebook" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/linux/1.ubuntu.html" class="sidebar-link">关于拿到一台阿里云服务器之后应该怎么做？</a></li><li><a href="/linux/2.caddy.html" class="sidebar-link">Caddy 食用方式</a></li><li><a href="/linux/3.ArchWSL2.html" aria-current="page" class="active sidebar-link">Arch-WSL2</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#创建环境" class="sidebar-link">创建环境</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#预先事项" class="sidebar-link">预先事项</a></li><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#安装-windows-terminal" class="sidebar-link">安装 Windows Terminal</a></li><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#安装-arch-wsl" class="sidebar-link">安装 Arch WSL</a></li><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#安装完后就可以通过windows-terminal启动arch了。" class="sidebar-link">安装完后就可以通过Windows Terminal启动Arch了。</a></li><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#换源更新" class="sidebar-link">换源更新</a></li><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#启用-multilib-库" class="sidebar-link">启用 multilib 库</a></li><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#添加-archlinuxcn-源" class="sidebar-link">添加 archlinuxcn 源</a></li><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#创建用户" class="sidebar-link">创建用户</a></li></ul></li><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#开始安装必用软件" class="sidebar-link">开始安装必用软件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#安装-zsh" class="sidebar-link">安装 zsh</a></li><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#使用-proxychains-代理终端程序" class="sidebar-link">使用 proxychains 代理终端程序</a></li><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#安装yay" class="sidebar-link">安装yay</a></li><li class="sidebar-sub-header"><a href="/linux/3.ArchWSL2.html#安装-antigen" class="sidebar-link">安装 antigen</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="arch-wsl2"><a href="#arch-wsl2" class="header-anchor">#</a> Arch-WSL2</h1> <h2 id="创建环境"><a href="#创建环境" class="header-anchor">#</a> 创建环境</h2> <h3 id="预先事项"><a href="#预先事项" class="header-anchor">#</a> 预先事项</h3> <p>WSL 2 要求系统版本应该在 Windows 10, Version 2004, Build 19041 及以上。</p> <p>以管理员身份打开 powershell，运行如下命令以启动需要的组件：</p> <div class="language-powershell line-numbers-mode"><pre class="language-powershell"><code>dism<span class="token punctuation">.</span>exe <span class="token operator">/</span>online <span class="token operator">/</span><span class="token function">enable-feature</span> <span class="token operator">/</span>featurename:Microsoft<span class="token operator">-</span>Windows<span class="token operator">-</span>Subsystem<span class="token operator">-</span>Linux <span class="token operator">/</span>all <span class="token operator">/</span>norestart
dism<span class="token punctuation">.</span>exe <span class="token operator">/</span>online <span class="token operator">/</span><span class="token function">enable-feature</span> <span class="token operator">/</span>featurename:VirtualMachinePlatform <span class="token operator">/</span>all <span class="token operator">/</span>norestart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后重启。并且在 此处 下载并安装适用于 x64 计算机的最新 WSL2 Linux 内核更新包。</p> <p>打开 powershell，运行如下命令以将 wsl 的默认版本设置为 WSL 2：</p> <div class="language-powershell line-numbers-mode"><pre class="language-powershell"><code>wsl <span class="token operator">--</span><span class="token function">set-default</span><span class="token operator">-</span>version 2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="安装-windows-terminal"><a href="#安装-windows-terminal" class="header-anchor">#</a> 安装 Windows Terminal</h3> <p>在微软的应用商店安装就行了。</p> <h3 id="安装-arch-wsl"><a href="#安装-arch-wsl" class="header-anchor">#</a> 安装 Arch WSL</h3> <p>在<a href="https://github.com/yuk7/ArchWSL/releases/tag/21.7.16.0" target="_blank" rel="noopener noreferrer">yuk7/ArchWSL - releases<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>下载Arch.zip，解压，双击 Arch.exe 进行安装。</p> <p>如果你解压到哪，那么Arch就会安装到哪。</p> <h3 id="安装完后就可以通过windows-terminal启动arch了。"><a href="#安装完后就可以通过windows-terminal启动arch了。" class="header-anchor">#</a> 安装完后就可以通过Windows Terminal启动Arch了。</h3> <p><img src="/assets/img/2021-07-31-22-54-55.4ce4037e.png" alt=""></p> <h3 id="换源更新"><a href="#换源更新" class="header-anchor">#</a> 换源更新</h3> <p>以下部分都以 root 用户身份运行命令。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">passwd</span> <span class="token comment"># 设置密码</span>
<span class="token comment"># 设置软件源</span>
<span class="token builtin class-name">echo</span> <span class="token string">'Server = https://mirrors.neusoft.edu.cn/archlinux/$repo/os/$arch'</span> <span class="token operator">&gt;</span> /etc/pacman.d/mirrorlist
<span class="token comment"># 初始化 keyring</span>
pacman-key --init
pacman-key --populate
pacman -Syu <span class="token comment"># 更新</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="启用-multilib-库"><a href="#启用-multilib-库" class="header-anchor">#</a> 启用 multilib 库</h3> <p>Arch Linux 有些软件是 32 位的，我们需要开启 multilib 才可以安装。</p> <p><code>nano /etc/pacman.conf</code>，取消这几行的注释：</p> <div class="language-ini line-numbers-mode"><pre class="language-ini"><code><span class="token header"><span class="token punctuation">[</span><span class="token section-name selector">multilib</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Include</span> <span class="token punctuation">=</span> <span class="token value attr-value">/etc/pacman.d/mirrorlist</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>并且取消该文件中<code>#Color</code>这一行的注释，以启用彩色输出。</p> <h3 id="添加-archlinuxcn-源"><a href="#添加-archlinuxcn-源" class="header-anchor">#</a> 添加 archlinuxcn 源</h3> <p>Arch Linux 中文社区仓库 是由 Arch Linux 中文社区驱动的非官方用户仓库。包含中文用户常用软件、工具、字体/美化包等。</p> <p><code>nano /etc/pacman.conf</code>，在文件末尾加上：</p> <div class="language-ini line-numbers-mode"><pre class="language-ini"><code><span class="token header"><span class="token punctuation">[</span><span class="token section-name selector">archlinuxcn</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">Server</span> <span class="token punctuation">=</span> <span class="token value attr-value">https://mirrors.aliyun.com/archlinuxcn/$arch</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>然后</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>pacman -Syy
pacman -S archlinuxcn-keyring
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="创建用户"><a href="#创建用户" class="header-anchor">#</a> 创建用户</h3> <p>注：此处的 yourname 是你要创建的用户名</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 新建用户。-m 为用户创建家目录；-G wheel 将用户添加到 wheel 用户组</span>
<span class="token function">useradd</span> -m -G wheel yourname
<span class="token comment"># 设置密码</span>
<span class="token function">passwd</span> yourname
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>将以下两行行首的<code>#</code>去掉。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># %wheel ALL=(ALL) ALL</span>
<span class="token comment"># %wheel ALL=(ALL) NOPASSWD: ALL</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在 powershell 中进入到 Arch.exe 所在文件夹，设置 WSL 默认登陆用户和默认的 WSL：</p> <div class="language-powershell line-numbers-mode"><pre class="language-powershell"><code><span class="token punctuation">.</span>\Arch<span class="token punctuation">.</span>exe config <span class="token operator">--</span>default<span class="token operator">-</span>user yourname
wsl <span class="token operator">-</span>s Arch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>重新打开，就是在 yourname 用户了。</p> <h2 id="开始安装必用软件"><a href="#开始安装必用软件" class="header-anchor">#</a> 开始安装必用软件</h2> <h3 id="安装-zsh"><a href="#安装-zsh" class="header-anchor">#</a> 安装 zsh</h3> <p>给 windows 安装以下字体，并且改变 windows terminal 的字体设置（百度吧，推荐 JetBrians Mono NF相关的）</p> <p>安装 zsh 并且将其设置为默认 shell</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> pacman -S --needed <span class="token function">zsh</span>
chsh -s /bin/zsh <span class="token comment"># 改变当前用户的默认shell</span>
<span class="token function">touch</span> ~/.zshrc <span class="token comment"># 创建zsh默认配置文件</span>
<span class="token comment"># 在yourname用户创建软链接，让root用户也使用yourname用户的.zshrc</span>
<span class="token comment"># 我觉得这样比较方便</span>
<span class="token function">sudo</span> <span class="token function">ln</span> -s ~/.zshrc /root/.zshrc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="使用-proxychains-代理终端程序"><a href="#使用-proxychains-代理终端程序" class="header-anchor">#</a> 使用 proxychains 代理终端程序</h3> <p>可以使用 windows 的 qv2ray 代理软件来代理 wsl 中的程序！先安装 proxychains：</p> <div class="language-powershell line-numbers-mode"><pre class="language-powershell"><code>sudo pacman <span class="token operator">-</span>S <span class="token operator">--</span>needed proxychains<span class="token operator">-</span>ng
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>首先，<code>sudo nano /etc/proxychains.conf</code>，将<code>proxy_dns</code>这一行注释。（这样能够让 proxychains 代理 yay）</p> <p>如果用的是 WSL 2，由于目前 WSL 2 和 windows 的 ip 不同，我们需要先<code>cp -f /etc/proxychains.conf ~/.proxychains.conf</code>，然后在<code>~/.zshrc</code>中添加以下内容：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 获取windows的ip</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">WIN_IP</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> /etc/resolv.conf <span class="token operator">|</span> <span class="token function">grep</span> nameserver <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $2}'</span><span class="token variable">`</span></span>
<span class="token comment"># 删除 ~/.proxychains.conf 中 [ProxyList] 所在行到文件末尾的全部内容</span>
<span class="token function">sed</span> -i <span class="token string">'/\[ProxyList\]/,$d'</span> ~/.proxychains.conf
<span class="token comment"># 往文件末尾添加socks5设置，这个 7890 是我的 qv②ray 的 socks5 端口号，改成你自己的</span>
<span class="token builtin class-name">echo</span> <span class="token string">'[ProxyList]\nsocks5 '</span><span class="token variable">${WIN_IP}</span><span class="token string">' 7890'</span> <span class="token operator">&gt;&gt;</span> ~/.proxychains.conf
<span class="token comment"># 设置别名；使用 ~/.proxychains.conf 作为proxychains的配置文件；让proxychains quiet（不输出一大串东西）</span>
<span class="token builtin class-name">alias</span> <span class="token assign-left variable">pc</span><span class="token operator">=</span><span class="token string">'proxychains4 -q -f ~/.proxychains.conf'</span>
<span class="token comment"># 用来手动开关代理，建议走 http 协议，因为 wget 不支持 socks5</span>
<span class="token assign-left variable">my_proxy</span><span class="token operator">=</span>http://<span class="token variable">${WIN_IP}</span>:7891
<span class="token builtin class-name">alias</span> p-on<span class="token operator">=</span><span class="token string">'export all_proxy='</span><span class="token variable">${my_proxy}</span><span class="token string">' http_proxy='</span><span class="token variable">${my_proxy}</span><span class="token string">' https_proxy='</span><span class="token variable">${my_proxy}</span><span class="token string">''</span>
<span class="token builtin class-name">alias</span> p-off<span class="token operator">=</span><span class="token string">'unset all_proxy http_proxy https_proxy'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>然后，在yournane用户中：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">ln</span> -s ~/.proxychains.conf /root/.proxychains.conf
<span class="token builtin class-name">source</span> ~/.zshrc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>接下来的的命令如果想走代理，只需要加上前缀<code>pc</code>即可。</p> <h3 id="安装yay"><a href="#安装yay" class="header-anchor">#</a> 安装yay</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> pacman -S --needed base-devel
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>出现<code>:: fakeroot is in IgnorePkg/IgnoreGroup. Install anyway? [Y/n]</code>，选 n，接下来一直回车即可。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> pacman -S --needed yay
<span class="token comment"># yay 换源</span>
yay --aururl <span class="token string">&quot;https://aur.tuna.tsinghua.edu.cn&quot;</span> --save
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="安装-antigen"><a href="#安装-antigen" class="header-anchor">#</a> 安装 antigen</h3> <p>使用 antigen 管理 zsh 的插件：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> pcaman -S antigen
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>往<code>~/.zshrc</code>中添加如下内容，以启用历史命令、按键绑定、命令补全、语法高亮、agnoster 主题</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 初始化 antigen</span>
<span class="token builtin class-name">source</span> /usr/share/zsh/share/antigen.zsh
<span class="token comment"># Load the oh-my-zsh's library</span>
<span class="token comment"># oh-my-zsh 会启用历史命令、按键绑定等功能</span>
antigen use oh-my-zsh
<span class="token comment"># 启用一些 bundle</span>
antigen bundle zsh-users/zsh-syntax-highlighting
antigen bundle zsh-users/zsh-autosuggestions
antigen bundle zsh-users/zsh-completions
<span class="token comment"># Load the theme</span>
antigen theme agnoster
<span class="token comment"># Tell antigen that you're done</span>
antigen apply
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>然后<code>pc zsh</code>，antigen 就会给你安装插件</p> <div class="custom-block warning"><p class="custom-block-title">关于zsh-autosuggestions插件导致粘贴内容很慢的问题</p> <p>在<code>.zshrc</code>文件中配置以下内容:</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># This speeds up pasting w/ autosuggest</span>
<span class="token comment"># https://github.com/zsh-users/zsh-autosuggestions/issues/238</span>
<span class="token function-name function">pasteinit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token assign-left variable">OLD_SELF_INSERT</span><span class="token operator">=</span><span class="token variable">${${(s.<span class="token operator">:</span>.)widgets<span class="token punctuation">[</span>self-insert<span class="token punctuation">]</span>}</span><span class="token punctuation">[</span><span class="token number">2,3</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
  zle -N self-insert url-quote-magic <span class="token comment"># I wonder if you'd need `.url-quote-magic`?</span>
<span class="token punctuation">}</span>
 
<span class="token function-name function">pastefinish</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  zle -N self-insert <span class="token variable">$OLD_SELF_INSERT</span>
<span class="token punctuation">}</span>
zstyle :bracketed-paste-magic paste-init pasteinit
zstyle :bracketed-paste-magic paste-finish pastefinish
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Therainisme/Notebook/edit/main/docs/linux/3.ArchWSL2.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页 ！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">8/13/2021, 10:08:21 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/linux/2.caddy.html" class="prev">
        Caddy 食用方式
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.cfcb1174.js" defer></script><script src="/assets/js/2.309a0ee7.js" defer></script><script src="/assets/js/14.ace9b7b0.js" defer></script>
  </body>
</html>
