# 反射

## 获取Class对象

* 知道具体类的情况下可以使用

```java
Class klass = TargetObject.class;
```

* 通过`Class.forName()`传入类的路径获取

```java
Class klass = Class.forName("com.therainisme.TO");
```

* 通过对象实例`instance.getClass()`获取

```java
TargetObject o = new TargetObject();
Class klass = o.getClass();
```

* 通过类加载器`ClassLoader.loadClass()`传入类路径获取

```java
Class klass = ClassLoader.getSystemClassLoader().loadClass("four");
```

## 反射创建该类实例

```java
Class<?> targetClass = Class.forName("com.therainisme.TO");
TO tO = (TO) tagetClass.newInstance();
```

## 反射获取类中所有方法

注意！不包括父类私有的方法，如果想获取父类的私有方法，调用`targetClass.getSuperclass()`获取父类方法后，在调用`getDeclaredMethods`

```java
Class<?> targetClass = Class.forName("com.therainisme.TO");
Method[] methods = tagetClass.getDeclaredMethods();
for (Method method : methods) {
    System.out.println(method.getName());
}
```

## 反射获取并调用某个方法

```java
List<Integer> list = new ArrayList<>();
Class<? extends List> klass = list.getClass();
Method method = klass.getDeclaredMethod("add", Object.class);

method.setAccessible(true); // 如果是私有方法必须取消安全检查

method.invoke(list, "This is a string");
```

## 反射修改类实例变量

```java
Class<?> targetClass = Class.forName("com.therainisme.TO");
// 这个value是该变量的名字（标识符）
Field field = targetClass.getDeclaredField("value");
//为了对类中的参数进行修改我们取消安全检查
field.setAccessible(true);
field.set(targetObject, "JavaGuide");
```